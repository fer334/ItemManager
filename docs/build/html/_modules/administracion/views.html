

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="es" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="es" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>administracion.views &mdash; documentación de ItemManager - 1.0</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/translations.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> ItemManager
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/login.models.html">login.models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/login.forms.html">login.forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/login.views.html">login.views</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/login.LoginBackEnd.html">login.LoginBackEnd</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/login.Register.html">login.Register</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/administracion.models.html">administracion.models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/administracion.views.html">administracion.views</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/administracion.forms.html">administracion.forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/desarrollo.models.html">desarrollo.models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/desarrollo.views.html">desarrollo.views</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/desarrollo.forms.html">desarrollo.forms</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ItemManager</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Código de módulo</a> &raquo;</li>
        
      <li>administracion.views</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Código fuente para administracion.views</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Modulo se detalla la logica para las vistas que serán utilizadas por la app</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># Django</span>
<span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponseRedirect</span>
<span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span><span class="p">,</span> <span class="n">redirect</span>
<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">reverse</span>
<span class="kn">from</span> <span class="nn">django.utils</span> <span class="kn">import</span> <span class="n">timezone</span>
<span class="c1"># Models</span>
<span class="kn">from</span> <span class="nn">administracion.models</span> <span class="kn">import</span> <span class="n">TipoItem</span><span class="p">,</span> <span class="n">Proyecto</span><span class="p">,</span> <span class="n">PlantillaAtributo</span><span class="p">,</span> <span class="n">Rol</span><span class="p">,</span> <span class="n">Fase</span><span class="p">,</span> <span class="n">UsuarioxRol</span>
<span class="kn">from</span> <span class="nn">login.models</span> <span class="kn">import</span> <span class="n">Usuario</span>
<span class="c1"># Forms</span>
<span class="kn">from</span> <span class="nn">administracion.forms</span> <span class="kn">import</span> <span class="n">ProyectoForm</span><span class="p">,</span> <span class="n">RolForm</span><span class="p">,</span> <span class="n">EditarTipoItemForm</span>
<span class="c1"># Python</span>
<span class="kn">import</span> <span class="nn">datetime</span>


<div class="viewcode-block" id="acceso_denegado"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.acceso_denegado">[documentos]</a><span class="k">def</span> <span class="nf">acceso_denegado</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">,</span> <span class="n">caso</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    vista que se encarga de desplegar la página de acceso denegado si es que se intenta ingresar</span>
<span class="sd">    a un url no permitido.</span>

<span class="sd">    :param caso: El caso es la clave para seleccionar el mensaje adecuado a desplegar</span>
<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto: identificador unico del proyecto</span>
<span class="sd">    :return: objeto que se encarga de renderear accesoDenegado.html</span>
<span class="sd">    :rtype: render</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
    <span class="n">posibles_casos</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;estado&#39;</span><span class="p">:</span> <span class="s1">&#39;No se permite el ingreso a esta URL porque el proyecto: &#39;</span> <span class="o">+</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">nombre</span> <span class="o">+</span> <span class="s1">&#39;  &#39;</span>
                                                                                                 <span class="s1">&#39;tiene estado actual: &#39;</span> <span class="o">+</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span><span class="p">,</span>
        <span class="s1">&#39;gerente&#39;</span><span class="p">:</span> <span class="s1">&#39;El usuario actual no puede acceder a esta URL porque no es el Gerente del Proyecto actual&#39;</span><span class="p">,</span>
        <span class="s1">&#39;tiimportado&#39;</span><span class="p">:</span> <span class="s1">&#39;No se puede editar este tipo de ítem porque se utiliza en otros proyectos&#39;</span>
    <span class="p">}</span>
    <span class="n">mensaje</span> <span class="o">=</span> <span class="n">posibles_casos</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">caso</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;administracion/accesoDenegado.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">,</span> <span class="s1">&#39;mensaje&#39;</span><span class="p">:</span> <span class="n">mensaje</span><span class="p">})</span></div>


<div class="viewcode-block" id="proyectos"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.proyectos">[documentos]</a><span class="k">def</span> <span class="nf">proyectos</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">filtro</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vista que despliega la lista de proyectos con su estado actual, también permite filtrar los proyectos según estado,</span>
<span class="sd">    además solo muestra los proyectos de los cuales es gerente el usuario que hizo el request</span>

<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param filtro: este parámetro indica el estado según se filtrarán los proyectos. Si el valor es &#39;todos&#39; no se aplicará ningún filtro</span>
<span class="sd">    :return: objeto que se encarga de renderear proyecto_ver_todos.html</span>
<span class="sd">    :rtype: render</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># lista final de proyectos con filtros de estado aplicados</span>
    <span class="n">lista_proyectos</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># lista con los proyectos en los que es gerente el usuario</span>
    <span class="n">lista_proyectos_usuario</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># lista sin ningún filtro de todos los proyectos del sistema</span>
    <span class="n">lista_todos_proyectos</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    # mostrar solo en los que el usuario participa</span>
<span class="sd">    for proye in lista_todos_proyectos:</span>
<span class="sd">        if proye.es_participante(request.user.id):</span>
<span class="sd">            lista_proyectos_usuario.append(proye)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">proye</span> <span class="ow">in</span> <span class="n">lista_todos_proyectos</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">proye</span><span class="o">.</span><span class="n">gerente</span> <span class="o">==</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
            <span class="n">lista_proyectos_usuario</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">proye</span><span class="p">)</span>

    <span class="c1"># filtrar según estado</span>
    <span class="k">if</span> <span class="n">filtro</span> <span class="o">==</span> <span class="s1">&#39;todos&#39;</span><span class="p">:</span>
        <span class="n">lista_proyectos</span> <span class="o">=</span> <span class="n">lista_proyectos_usuario</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">proyecto</span> <span class="ow">in</span> <span class="n">lista_proyectos_usuario</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="n">filtro</span><span class="p">:</span>
                <span class="n">lista_proyectos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">proyecto</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;administracion/proyectos.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;lista_proyectos&#39;</span><span class="p">:</span> <span class="n">lista_proyectos</span><span class="p">,</span> <span class="s1">&#39;filtro&#39;</span><span class="p">:</span> <span class="n">filtro</span><span class="p">})</span></div>


<div class="viewcode-block" id="crear_proyecto"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.crear_proyecto">[documentos]</a><span class="k">def</span> <span class="nf">crear_proyecto</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    esta vista se encarga de la creación del proyecto, primeramente verifica si el metodo del request es POST, de no</span>
<span class="sd">    ser retorna un form vacío y de ser pasa el request como parametro al form y el form retorna como &#39;cleaned_data&#39;</span>
<span class="sd">    los datos para crear el proyecto. Para el gerente se guarda el id del usuario que realiza el request y luego se</span>
<span class="sd">    guarda al gerente como el primer usuario participante del proyecto. Además se crean la cantidad de fases que</span>
<span class="sd">    indica el atributo del proyecto: &#39;numero_fases&#39;, estas fases se crean con datos provisionales que luego pueden</span>
<span class="sd">    ser modificados por el usuario. Finalmente, luego de ser creado el proyecto la vista redirecciona a la otra vista</span>
<span class="sd">    ver_proyecto.</span>

<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :return: objeto que se encarga de renderear a crearProyecto.html o en caso de POST redireccion a verProyecto.html</span>
<span class="sd">    :rtype: render, redirect</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">ProyectoForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
            <span class="c1"># primero registramos los atributos en el proyecto</span>
            <span class="n">nombre</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span>
            <span class="n">fecha_inicio</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;fecha_inicio&#39;</span><span class="p">]</span>
            <span class="n">numero_fases</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;numero_fases&#39;</span><span class="p">]</span>
            <span class="n">cant_comite</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;cant_comite&#39;</span><span class="p">]</span>
            <span class="c1"># establecemos al usuario que crea el proyecto como gerente</span>
            <span class="n">gerente</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span>
            <span class="n">nuevo_proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="p">(</span><span class="n">nombre</span><span class="o">=</span><span class="n">nombre</span><span class="p">,</span> <span class="n">fecha_inicio</span><span class="o">=</span><span class="n">fecha_inicio</span><span class="p">,</span> <span class="n">numero_fases</span><span class="o">=</span><span class="n">numero_fases</span><span class="p">,</span>
                                      <span class="n">cant_comite</span><span class="o">=</span><span class="n">cant_comite</span><span class="p">,</span> <span class="n">gerente</span><span class="o">=</span><span class="n">gerente</span><span class="p">)</span>
            <span class="n">nuevo_proyecto</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="c1"># ponemos al gerente como participante en el proyecto</span>
            <span class="n">participante</span> <span class="o">=</span> <span class="n">Usuario</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">gerente</span><span class="p">)</span>
            <span class="n">nuevo_proyecto</span><span class="o">.</span><span class="n">participantes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">participante</span><span class="p">)</span>
            <span class="c1"># creamos la cantidad de fases para este proyecto</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nuevo_proyecto</span><span class="o">.</span><span class="n">numero_fases</span><span class="p">):</span>
                <span class="n">nueva_fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="p">(</span><span class="n">nombre</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">descripcion</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">proyecto</span><span class="o">=</span><span class="n">nuevo_proyecto</span><span class="p">)</span>
                <span class="n">nueva_fase</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:verProyecto&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">nuevo_proyecto</span><span class="o">.</span><span class="n">id</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">ProyectoForm</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;administracion/crearProyecto.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;form&#39;</span><span class="p">:</span> <span class="n">form</span><span class="p">})</span></div>


<div class="viewcode-block" id="ver_proyecto"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.ver_proyecto">[documentos]</a><span class="k">def</span> <span class="nf">ver_proyecto</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Esta vista despliega un proyecto con todos los valores que toman sus atributos, además de sus fases, roles</span>
<span class="sd">    y tipos de ítems</span>

<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto: Se recibe como parámetro el id_del proyecto que se desea ver</span>
<span class="sd">    :return: objeto que renderea verProyecto.html</span>
<span class="sd">    :rtype: render</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
    <span class="n">gerente</span> <span class="o">=</span> <span class="n">Usuario</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">proyecto</span><span class="o">.</span><span class="n">gerente</span><span class="p">)</span>
    <span class="n">tipo_item</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">tipoitem_set</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
    <span class="n">fases</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">fase_set</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
    <span class="n">estados_posibles</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;iniciado&#39;</span><span class="p">:</span> <span class="s1">&#39;Iniciado&#39;</span><span class="p">,</span>
        <span class="s1">&#39;en ejecucion&#39;</span><span class="p">:</span> <span class="s1">&#39;En Ejecución&#39;</span><span class="p">,</span>
        <span class="s1">&#39;finalizado&#39;</span><span class="p">:</span> <span class="s1">&#39;Finalizado&#39;</span><span class="p">,</span>
        <span class="s1">&#39;cancelado&#39;</span><span class="p">:</span> <span class="s1">&#39;Cancelado&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">estado</span> <span class="o">=</span> <span class="n">estados_posibles</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span><span class="p">)</span>
    <span class="n">habilitadofase</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">habilitadocomite</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">habilitadotipo</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">lista_fases</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">fase_set</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">fase</span> <span class="ow">in</span> <span class="n">lista_fases</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">fase</span><span class="o">.</span><span class="n">nombre</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">habilitadofase</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">comite</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">!=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">cant_comite</span><span class="p">:</span>
        <span class="n">habilitadocomite</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">tipoitem_set</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">numero_fases</span><span class="p">:</span>
        <span class="n">habilitadotipo</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;administracion/verProyecto.html&#39;</span><span class="p">,</span>
                  <span class="p">{</span><span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">,</span> <span class="s1">&#39;gerente&#39;</span><span class="p">:</span> <span class="n">gerente</span><span class="p">,</span> <span class="s1">&#39;tipo_item&#39;</span><span class="p">:</span> <span class="n">tipo_item</span><span class="p">,</span> <span class="s1">&#39;fases&#39;</span><span class="p">:</span> <span class="n">fases</span><span class="p">,</span> <span class="s1">&#39;estado&#39;</span><span class="p">:</span> <span class="n">estado</span><span class="p">,</span>
                   <span class="s1">&#39;habilitadofase&#39;</span><span class="p">:</span> <span class="n">habilitadofase</span><span class="p">,</span> <span class="s1">&#39;habilitadocomite&#39;</span><span class="p">:</span> <span class="n">habilitadocomite</span><span class="p">,</span>
                   <span class="s1">&#39;habilitadotipo&#39;</span><span class="p">:</span> <span class="n">habilitadotipo</span><span class="p">})</span></div>


<div class="viewcode-block" id="administrar_participantes"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.administrar_participantes">[documentos]</a><span class="k">def</span> <span class="nf">administrar_participantes</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Esta vista permite añadir y sacar participantes del proyecto, además también acceder a los roles de un</span>
<span class="sd">    participante</span>

<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto: identidficar del proyecto sobre el cual se quiere administrar sus participantes</span>
<span class="sd">    :return: objeto que renderea administrarParticipantes.html y en caso de post que redirecciona</span>
<span class="sd">    :rtype: render, redirect</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;cancelado&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;estado&#39;</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">gerente</span> <span class="o">!=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;gerente&#39;</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lista_usuarios</span> <span class="o">=</span> <span class="n">Usuario</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
            <span class="n">id_usuario</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;participante&#39;</span><span class="p">]</span>
            <span class="n">participante</span> <span class="o">=</span> <span class="n">Usuario</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_usuario</span><span class="p">)</span>
            <span class="n">proyecto</span><span class="o">.</span><span class="n">participantes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">participante</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:administrarParticipantes&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">proyecto</span><span class="o">.</span><span class="n">id</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;administracion/administrarParticipantes.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">,</span>
                                                                                <span class="s1">&#39;lista_usuarios&#39;</span><span class="p">:</span> <span class="n">lista_usuarios</span><span class="p">})</span></div>


<div class="viewcode-block" id="editar_proyecto"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.editar_proyecto">[documentos]</a><span class="k">def</span> <span class="nf">editar_proyecto</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vista que permite editar los datos del proyecto seleccionado</span>

<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto: proyecto seleccionado para ser modificado</span>
<span class="sd">    :return: objeto que se encarga de renderear editarProyecto.html</span>
<span class="sd">    :rtype: render</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;cancelado&#39;</span> <span class="ow">or</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;finalizado&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;estado&#39;</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">gerente</span> <span class="o">!=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;gerente&#39;</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
            <span class="n">nombre</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span>
            <span class="n">fecha_inicio</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;fecha_inicio&#39;</span><span class="p">]</span>
            <span class="n">proyecto</span><span class="o">.</span><span class="n">nombre</span> <span class="o">=</span> <span class="n">nombre</span>
            <span class="n">proyecto</span><span class="o">.</span><span class="n">fecha_inicio</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">fecha_inicio</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">proyecto</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;administracion/editarProyecto.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">})</span>

        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;administracion/editarProyecto.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">})</span></div>


<div class="viewcode-block" id="estado_proyecto"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.estado_proyecto">[documentos]</a><span class="k">def</span> <span class="nf">estado_proyecto</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    vista que permite seleccionar y cambiar el estado de un proyecto. Bloquea el paso a estado de ejecución si las</span>
<span class="sd">    fases no están definidas o el comité no está completo</span>

<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto: id del proyecto el cual se desea administrar su estado</span>
<span class="sd">    :return: objeto que renderea estadoProyecto.html o redireccion al mismo html</span>
<span class="sd">    :rtype: render, redirect</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">gerente</span> <span class="o">!=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;gerente&#39;</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">habilitadofase</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">habilitadocomite</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">estados_posibles</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;iniciado&#39;</span><span class="p">:</span> <span class="s1">&#39;Iniciado&#39;</span><span class="p">,</span>
            <span class="s1">&#39;en ejecucion&#39;</span><span class="p">:</span> <span class="s1">&#39;En Ejecución&#39;</span><span class="p">,</span>
            <span class="s1">&#39;finalizado&#39;</span><span class="p">:</span> <span class="s1">&#39;Finalizado&#39;</span><span class="p">,</span>
            <span class="s1">&#39;cancelado&#39;</span><span class="p">:</span> <span class="s1">&#39;Cancelado&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">estado</span> <span class="o">=</span> <span class="n">estados_posibles</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span><span class="p">)</span>

        <span class="n">lista_fases</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">fase_set</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">fase</span> <span class="ow">in</span> <span class="n">lista_fases</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fase</span><span class="o">.</span><span class="n">nombre</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">habilitadofase</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">comite</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">!=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">cant_comite</span><span class="p">:</span>
            <span class="n">habilitadocomite</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
            <span class="n">estado</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;estado&#39;</span><span class="p">]</span>
            <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">=</span> <span class="n">estado</span>
            <span class="n">proyecto</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:estadoProyecto&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;administracion/estadoProyecto.html&#39;</span><span class="p">,</span>
                  <span class="p">{</span><span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">,</span> <span class="s1">&#39;habilitadofase&#39;</span><span class="p">:</span> <span class="n">habilitadofase</span><span class="p">,</span> <span class="s1">&#39;habilitadocomite&#39;</span><span class="p">:</span> <span class="n">habilitadocomite</span><span class="p">,</span>
                   <span class="s1">&#39;estado&#39;</span><span class="p">:</span> <span class="n">estado</span><span class="p">})</span></div>


<div class="viewcode-block" id="estado_proyectov2"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.estado_proyectov2">[documentos]</a><span class="k">def</span> <span class="nf">estado_proyectov2</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">,</span> <span class="n">estado</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    vista que permite seleccionar y cambiar el estado de un proyecto. Bloquea el paso a estado de ejecución si las</span>
<span class="sd">    fases no están definidas o el comité no está completo</span>

<span class="sd">    :param estado: estado nuevo a asignar</span>
<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto: id del proyecto el cual se desea administrar su estado</span>
<span class="sd">    :return: objeto que renderea estadoProyecto.html o redireccion al mismo html</span>
<span class="sd">    :rtype: render, redirect</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">gerente</span> <span class="o">!=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;gerente&#39;</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;iniciado&#39;</span> <span class="ow">or</span> <span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;en ejecucion&#39;</span> <span class="ow">or</span> <span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;finalizado&#39;</span> <span class="ow">or</span> <span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;cancelado&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;finalizado&#39;</span> <span class="ow">and</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">!=</span> <span class="s1">&#39;en ejecucion&#39;</span><span class="p">):</span>
                <span class="c1"># se modifica el estado</span>
                <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">=</span> <span class="n">estado</span>
                <span class="c1"># se añade la fecha de modificación</span>
                <span class="k">if</span> <span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;en ejecucion&#39;</span><span class="p">:</span>
                    <span class="n">proyecto</span><span class="o">.</span><span class="n">fecha_ejecucion</span> <span class="o">=</span> <span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
                <span class="k">elif</span> <span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;finalizado&#39;</span><span class="p">:</span>
                    <span class="n">proyecto</span><span class="o">.</span><span class="n">fecha_finalizado</span> <span class="o">=</span> <span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
                <span class="k">elif</span> <span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;cancelado&#39;</span><span class="p">:</span>
                    <span class="n">proyecto</span><span class="o">.</span><span class="n">fecha_cancelado</span> <span class="o">=</span> <span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
                <span class="c1"># se guardan cambios en la base de datos</span>
                <span class="n">proyecto</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:verProyecto&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;administracion:verProyecto&#39;</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span></div>


<div class="viewcode-block" id="administrar_fases_del_proyecto"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.administrar_fases_del_proyecto">[documentos]</a><span class="k">def</span> <span class="nf">administrar_fases_del_proyecto</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    vista que permite modificar los nombres y las descripciones de las fases del proyecto</span>

<span class="sd">    :param request: objeto de tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto: id del proyecto cuyas fases se quieren editar</span>
<span class="sd">    :return: objeto que renderea administrarFasesProyecto.html o redireccion a verProyecto.html</span>
<span class="sd">    :rtype: render, redirect</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;cancelado&#39;</span> <span class="ow">or</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;finalizado&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;estado&#39;</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">gerente</span> <span class="o">!=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;gerente&#39;</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fases</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">fase_set</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
            <span class="n">ids</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span>
            <span class="k">for</span> <span class="n">id_fase</span><span class="p">,</span> <span class="n">valor</span> <span class="ow">in</span> <span class="n">ids</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">id_fase</span> <span class="o">!=</span> <span class="s1">&#39;csrfmiddlewaretoken&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">id_fase</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="ow">or</span> <span class="n">id_fase</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span>
                        <span class="c1"># si encuentra una d antes es una descripcion</span>
                        <span class="k">if</span> <span class="n">id_fase</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_fase</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
                            <span class="n">fase</span><span class="o">.</span><span class="n">descripcion</span> <span class="o">=</span> <span class="n">valor</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_fase</span><span class="p">)</span>
                            <span class="n">fase</span><span class="o">.</span><span class="n">nombre</span> <span class="o">=</span> <span class="n">valor</span>
                        <span class="n">fase</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:verProyecto&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">proyecto</span><span class="o">.</span><span class="n">id</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;administracion/administrarFasesProyecto.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">,</span> <span class="s1">&#39;fases&#39;</span><span class="p">:</span> <span class="n">fases</span><span class="p">})</span></div>


<div class="viewcode-block" id="administrar_comite"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.administrar_comite">[documentos]</a><span class="k">def</span> <span class="nf">administrar_comite</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    vista que permite administrar que participantes del proyecto formaran parte del comité de decisión</span>

<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto: id del proyecto del cual se quiere administrar su comité</span>
<span class="sd">    :return: objeto que renderea administrarComite.html o redireción</span>
<span class="sd">    :rtype: render, redirect</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;cancelado&#39;</span> <span class="ow">or</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;finalizado&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;estado&#39;</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">gerente</span> <span class="o">!=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;gerente&#39;</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
            <span class="n">id_usuario</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;miembro_comite&#39;</span><span class="p">]</span>
            <span class="n">miembro_comite</span> <span class="o">=</span> <span class="n">Usuario</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_usuario</span><span class="p">)</span>
            <span class="n">proyecto</span><span class="o">.</span><span class="n">comite</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">miembro_comite</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:administrarComite&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">proyecto</span><span class="o">.</span><span class="n">id</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;administracion/administrarComite.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">})</span></div>


<div class="viewcode-block" id="eliminar_participante_y_comite"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.eliminar_participante_y_comite">[documentos]</a><span class="k">def</span> <span class="nf">eliminar_participante_y_comite</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">,</span> <span class="n">id_usuario</span><span class="p">,</span> <span class="n">caso</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vista que permite sacar a un usuario ya sea del proyecto completo o del comité de decisión del proyecto.</span>

<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto: id del proyecto seleccionado</span>
<span class="sd">    :param id_usuario: id del usuario que saldrá del comité o del proyecto</span>
<span class="sd">    :param caso: toma los valores &#39;comite&#39; y &#39;participante&#39; indica si se desea sacar al usuario del comité o del proyecto completo</span>
<span class="sd">    :return: redireccion a administrarComite.html o administrarParticipantes.html dependiendo del caso</span>
<span class="sd">    :rtype: redirect</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
    <span class="n">usuario</span> <span class="o">=</span> <span class="n">Usuario</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_usuario</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">caso</span> <span class="o">==</span> <span class="s1">&#39;comite&#39;</span><span class="p">:</span>
        <span class="n">proyecto</span><span class="o">.</span><span class="n">comite</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">usuario</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:administrarComite&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">proyecto</span><span class="o">.</span><span class="n">id</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="n">caso</span> <span class="o">==</span> <span class="s1">&#39;participante&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">gerente</span> <span class="o">!=</span> <span class="n">usuario</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
            <span class="n">proyecto</span><span class="o">.</span><span class="n">participantes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">usuario</span><span class="p">)</span>
            <span class="n">proyecto</span><span class="o">.</span><span class="n">comite</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">usuario</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:administrarParticipantes&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">proyecto</span><span class="o">.</span><span class="n">id</span><span class="p">]))</span></div>


<span class="k">def</span> <span class="nf">mostrar_tipo_item</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">tipo_items</span> <span class="o">=</span> <span class="n">TipoItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;administracion/tipoItemTest.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;lista_tipoitem&#39;</span><span class="p">:</span> <span class="n">tipo_items</span><span class="p">})</span>


<div class="viewcode-block" id="mostrar_tipo_import"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.mostrar_tipo_import">[documentos]</a><span class="k">def</span> <span class="nf">mostrar_tipo_import</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vista que en la cual se muestra los tipos de item del proyecto</span>

<span class="sd">    :return: redirecciona al url imṕortarTipoItem.html</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">tipo_item_proyecto_actual</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span><span class="o">.</span><span class="n">tipoitem_set</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
    <span class="n">tipo_items</span> <span class="o">=</span> <span class="p">[</span><span class="n">tipo</span> <span class="k">for</span> <span class="n">tipo</span> <span class="ow">in</span> <span class="n">TipoItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">tipo</span> <span class="ow">in</span> <span class="n">tipo_item_proyecto_actual</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;administracion/importarTipoItem.html&#39;</span><span class="p">,</span>
                  <span class="p">{</span><span class="s1">&#39;lista_tipoitem&#39;</span><span class="p">:</span> <span class="n">tipo_items</span><span class="p">,</span> <span class="s1">&#39;id_proyecto&#39;</span><span class="p">:</span> <span class="n">id_proyecto</span><span class="p">})</span></div>


<div class="viewcode-block" id="importar_tipo"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.importar_tipo">[documentos]</a><span class="k">def</span> <span class="nf">importar_tipo</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">,</span> <span class="n">id_tipo</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vista que permite traer de otro proyecto su tipo de item con sus</span>
<span class="sd">    respectivos atributos</span>

<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto: Identificador del proyecto</span>
<span class="sd">    :param id_tipo: identificador del tipo de item</span>
<span class="sd">    :return: redireccion a los permisos de acceso, en este caso si el proyecto es cancelado, finalizado o en ejecucion, deriva a un acceso denegado sino a verProyecto.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tipo_item</span> <span class="o">=</span> <span class="n">TipoItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_tipo</span><span class="p">)</span>
    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;cancelado&#39;</span> <span class="ow">or</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;finalizado&#39;</span> <span class="ow">or</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;en ejecución&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;estado&#39;</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">gerente</span> <span class="o">!=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;gerente&#39;</span><span class="p">]))</span>
    <span class="n">tipo_item</span><span class="o">.</span><span class="n">proyecto</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">proyecto</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;administracion:tipoItemPorProyecto&#39;</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span></div>


<div class="viewcode-block" id="crear_tipo"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.crear_tipo">[documentos]</a><span class="k">def</span> <span class="nf">crear_tipo</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vista en la cual se crean los tipos de item de los proyectos</span>

<span class="sd">    :param request:  objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto: identificador del proyecto</span>
<span class="sd">    :return: redirecciona a los permisos de acceso si el proyecto  es cancelado, finalizado o en ejecucion, deriva a un acceso denegado sino redirecciona a crearTipoItem.html mediante el id_proyecto.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;cancelado&#39;</span> <span class="ow">or</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;finalizado&#39;</span> <span class="ow">or</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;en ejecución&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;estado&#39;</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">gerente</span> <span class="o">!=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;gerente&#39;</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;administracion/crearTipoItem.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;id_proyecto&#39;</span><span class="p">:</span> <span class="n">id_proyecto</span><span class="p">})</span></div>


<div class="viewcode-block" id="editar_tipo"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.editar_tipo">[documentos]</a><span class="k">def</span> <span class="nf">editar_tipo</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">,</span> <span class="n">id_tipo</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vista en la cual se editan los tipos de item</span>

<span class="sd">    :param id_tipo: id del tipo de ítem a editar</span>
<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto:identificador del proyecto</span>
<span class="sd">    :return: redirecciona a los permisos de acceso si el tipo de item es usado en mas de un proyecto o si el proyecto</span>
<span class="sd">     ya inicio</span>
<span class="sd">     &quot;&quot;&quot;</span>
    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
    <span class="n">tipo</span> <span class="o">=</span> <span class="n">TipoItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_tipo</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;cancelado&#39;</span> <span class="ow">or</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;finalizado&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;estado&#39;</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">gerente</span> <span class="o">!=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;gerente&#39;</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">tipo</span><span class="o">.</span><span class="n">proyecto</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="n">caso</span><span class="o">=</span><span class="s1">&#39;tiimportado&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
            <span class="n">form</span> <span class="o">=</span> <span class="n">EditarTipoItemForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
                <span class="n">nombre</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span>
                <span class="n">prefijo</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;prefijo&#39;</span><span class="p">]</span>
                <span class="n">descripcion</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;descripcion&#39;</span><span class="p">]</span>
                <span class="n">tipo</span><span class="o">.</span><span class="n">nombre</span> <span class="o">=</span> <span class="n">nombre</span>
                <span class="n">tipo</span><span class="o">.</span><span class="n">prefijo</span> <span class="o">=</span> <span class="n">prefijo</span>
                <span class="n">tipo</span><span class="o">.</span><span class="n">descripcion</span> <span class="o">=</span> <span class="n">descripcion</span>
                <span class="n">tipo</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;administracion:tipoItemPorProyecto&#39;</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">EditarTipoItemForm</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;administracion/editarTipoItem.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;form&#39;</span><span class="p">:</span> <span class="n">form</span><span class="p">})</span></div>


<div class="viewcode-block" id="ver_tipo"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.ver_tipo">[documentos]</a><span class="k">def</span> <span class="nf">ver_tipo</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">,</span> <span class="n">id_tipo</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vista en la cual se ve los tipos de items del proyecto</span>

<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto: identificador del proyecto</span>
<span class="sd">    :param id_tipo: identificador del tipo de item</span>
<span class="sd">    :return: redirecciona a los permisos de acceso si el proyecto  es cancelado, finalizado o en ejecucion, deriva a un acceso denegado sino redirecciona al url verTipoItem.html</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">obj_proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">obj_proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;cancelado&#39;</span> <span class="ow">or</span> <span class="n">obj_proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;finalizado&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;estado&#39;</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="n">obj_proyecto</span><span class="o">.</span><span class="n">gerente</span> <span class="o">!=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;gerente&#39;</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">obj_tipo_item</span> <span class="o">=</span> <span class="n">TipoItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_tipo</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;administracion/verTipoItem.html&#39;</span><span class="p">,</span>
                      <span class="p">{</span><span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">obj_proyecto</span><span class="p">,</span> <span class="s1">&#39;tipo_item&#39;</span><span class="p">:</span> <span class="n">obj_tipo_item</span><span class="p">})</span></div>


<div class="viewcode-block" id="desactivar_tipo_item"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.desactivar_tipo_item">[documentos]</a><span class="k">def</span> <span class="nf">desactivar_tipo_item</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">,</span> <span class="n">id_tipo</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vista que desactiva los tipos de item del proyecto recibido, solo lo hace si el proyecto aun no esta iniciado</span>
<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto: identificador del proyecto</span>
<span class="sd">    :param id_tipo: identificador del tipo de item</span>
<span class="sd">    :return: redirecciona a la vista de administracion del tipo de item</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">tipo_item</span> <span class="o">=</span> <span class="n">TipoItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_tipo</span><span class="p">)</span>
    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;iniciado&#39;</span><span class="p">:</span>
        <span class="n">tipo_item</span><span class="o">.</span><span class="n">proyecto</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">proyecto</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;administracion:tipoItemPorProyecto&#39;</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span></div>


<div class="viewcode-block" id="confirmar_tipo_import"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.confirmar_tipo_import">[documentos]</a><span class="k">def</span> <span class="nf">confirmar_tipo_import</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">,</span> <span class="n">id_tipo</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vista en la cual se confirma el tipo de item a utilizar</span>

<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto: identificador del proyecto</span>
<span class="sd">    :param id_tipo: identificador del tipo de item</span>
<span class="sd">    :return: redirecciona a los permisos de acceso si el proyecto  es cancelado, finalizado o en ejecucion, deriva a un acceso denegado sino redirecciona al url verTipoItemParaImport.html para ver que tipos de items importar.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">obj_proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">obj_proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;cancelado&#39;</span> <span class="ow">or</span> <span class="n">obj_proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;finalizado&#39;</span> <span class="ow">or</span> \
            <span class="n">obj_proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;en ejecución&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;estado&#39;</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="n">obj_proyecto</span><span class="o">.</span><span class="n">gerente</span> <span class="o">!=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;gerente&#39;</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">obj_tipo_item</span> <span class="o">=</span> <span class="n">TipoItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_tipo</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;administracion/verTipoItemParaImport.html&#39;</span><span class="p">,</span>
                      <span class="p">{</span><span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">obj_proyecto</span><span class="p">,</span> <span class="s1">&#39;tipo_item&#39;</span><span class="p">:</span> <span class="n">obj_tipo_item</span><span class="p">})</span></div>


<div class="viewcode-block" id="ver_tipo_por_proyecto"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.ver_tipo_por_proyecto">[documentos]</a><span class="k">def</span> <span class="nf">ver_tipo_por_proyecto</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vista que permite ver el tipo de item por proyectos</span>

<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto: identificador del proyecto</span>
<span class="sd">    :return: redirecciona a los permisos de acceso si el proyecto  es cancelado, finalizado o en ejecucion, deriva a un acceso denegado sino redirecciona al url tipoItemTest.html</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;cancelado&#39;</span> <span class="ow">or</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;finalizado&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;estado&#39;</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">gerente</span> <span class="o">!=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;gerente&#39;</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tipo_item</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">tipoitem_set</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;administracion/administrarTipoItem.html&#39;</span><span class="p">,</span> <span class="p">{</span>
            <span class="s1">&#39;lista_tipoitem&#39;</span><span class="p">:</span> <span class="n">tipo_item</span><span class="p">,</span>
            <span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span>
        <span class="p">})</span></div>


<div class="viewcode-block" id="registrar_tipoitem_en_base"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.registrar_tipoitem_en_base">[documentos]</a><span class="k">def</span> <span class="nf">registrar_tipoitem_en_base</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vista en la cual se registran los tipos de item a utilizar en el proyecto</span>

<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto: identificador del proyecto</span>
<span class="sd">    :return: redirecciona a los permisos de acceso si el proyecto  es cancelado, finalizado o en ejecucion, deriva a un acceso denegado sino redirecciona a verTipoItem.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;cancelado&#39;</span> <span class="ow">or</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;finalizado&#39;</span> <span class="ow">or</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;en ejecución&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;estado&#39;</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">gerente</span> <span class="o">!=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;gerente&#39;</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nombre</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span>
        <span class="n">descripcion</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;descripcion&#39;</span><span class="p">]</span>
        <span class="n">prefijo</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;prefijo&#39;</span><span class="p">]</span>
        <span class="n">nuevo_tipo_item</span> <span class="o">=</span> <span class="n">TipoItem</span><span class="p">(</span><span class="n">nombre</span><span class="o">=</span><span class="n">nombre</span><span class="p">,</span> <span class="n">descripcion</span><span class="o">=</span><span class="n">descripcion</span><span class="p">,</span> <span class="n">prefijo</span><span class="o">=</span><span class="n">prefijo</span><span class="p">)</span>
        <span class="n">nuevo_tipo_item</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">nuevo_tipo_item</span><span class="o">.</span><span class="n">proyecto</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">proyecto</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:verTipoItem&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="n">nuevo_tipo_item</span><span class="o">.</span><span class="n">id</span><span class="p">)))</span></div>


<div class="viewcode-block" id="crear_atributo"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.crear_atributo">[documentos]</a><span class="k">def</span> <span class="nf">crear_atributo</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">,</span> <span class="n">id_tipo</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vista en la cual se permite crear los atributos de los tipos de item del proyecto</span>

<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto: identificador del proyecto</span>
<span class="sd">    :param id_tipo: identificador del tipo de item</span>
<span class="sd">    :return: redireccion a verTipoItem</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nombre</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span>
    <span class="n">tipo</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;tipo&#39;</span><span class="p">]</span>
    <span class="n">is_required</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;required&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span>
    <span class="n">tipo_item</span> <span class="o">=</span> <span class="n">TipoItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_tipo</span><span class="p">)</span>
    <span class="n">atributo</span> <span class="o">=</span> <span class="n">PlantillaAtributo</span><span class="p">(</span><span class="n">nombre</span><span class="o">=</span><span class="n">nombre</span><span class="p">,</span> <span class="n">tipo</span><span class="o">=</span><span class="n">tipo</span><span class="p">,</span> <span class="n">tipo_item</span><span class="o">=</span><span class="n">tipo_item</span><span class="p">,</span> <span class="n">es_requerido</span><span class="o">=</span><span class="n">is_required</span><span class="p">)</span>
    <span class="n">atributo</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:verTipoItem&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="n">tipo_item</span><span class="o">.</span><span class="n">id</span><span class="p">)))</span></div>


<div class="viewcode-block" id="quitar_atributo"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.quitar_atributo">[documentos]</a><span class="k">def</span> <span class="nf">quitar_atributo</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">,</span> <span class="n">id_tipo</span><span class="p">,</span> <span class="n">id_atributo</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vista que permite quitar los atributos de los tipos de item</span>

<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto: identificador del proyecto</span>
<span class="sd">    :param id_tipo: identificador del tipo de item</span>
<span class="sd">    :param id_atributo: identificador del atributo</span>
<span class="sd">    :return: redirecciona a verTipoItem</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">atributo</span> <span class="o">=</span> <span class="n">PlantillaAtributo</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_atributo</span><span class="p">)</span>
    <span class="n">atributo</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:verTipoItem&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="n">id_tipo</span><span class="p">)))</span></div>


<div class="viewcode-block" id="crear_rol"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.crear_rol">[documentos]</a><span class="k">def</span> <span class="nf">crear_rol</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vista en la cual se crean los roles del proyecto</span>

<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto: identificador del proyecto</span>
<span class="sd">    :return: redirecciona a los permisos de acceso si el proyecto  es cancelado, finalizado o en ejecucion, deriva a un acceso denegado sino redirecciona primeramente a verProyecto si el metodo corresponde a &#39;POST&#39; y luego va al formulario correspondiente al rol y si es valido crean los roles con sus respectivos permisos y atributos, y retorna al verProyecto, luego va de al formulario para crear el nuevo rol y por ultmo redirecciona a crearRol.html</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;cancelado&#39;</span> <span class="ow">or</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;finalizado&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;estado&#39;</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">gerente</span> <span class="o">!=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;gerente&#39;</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
            <span class="n">form</span> <span class="o">=</span> <span class="n">RolForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
                <span class="n">nombre</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span>
                <span class="n">crear_item</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;crear_item&#39;</span><span class="p">]</span>
                <span class="n">modificar_item</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;modificar_item&#39;</span><span class="p">]</span>
                <span class="n">desactivar_item</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;desactivar_item&#39;</span><span class="p">]</span>
                <span class="n">aprobar_item</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;aprobar_item&#39;</span><span class="p">]</span>
                <span class="n">reversionar_item</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;reversionar_item&#39;</span><span class="p">]</span>
                <span class="n">crear_relaciones_ph</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;crear_relaciones_ph&#39;</span><span class="p">]</span>
                <span class="n">crear_relaciones_as</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;crear_relaciones_as&#39;</span><span class="p">]</span>
                <span class="n">borrar_relaciones</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;borrar_relaciones&#39;</span><span class="p">]</span>
                <span class="n">nuevo_rol</span> <span class="o">=</span> <span class="n">Rol</span><span class="p">(</span><span class="n">nombre</span><span class="o">=</span><span class="n">nombre</span><span class="p">,</span> <span class="n">crear_item</span><span class="o">=</span><span class="n">crear_item</span><span class="p">,</span> <span class="n">modificar_item</span><span class="o">=</span><span class="n">modificar_item</span><span class="p">,</span>
                                <span class="n">desactivar_item</span><span class="o">=</span><span class="n">desactivar_item</span><span class="p">,</span>
                                <span class="n">aprobar_item</span><span class="o">=</span><span class="n">aprobar_item</span><span class="p">,</span> <span class="n">reversionar_item</span><span class="o">=</span><span class="n">reversionar_item</span><span class="p">,</span>
                                <span class="n">crear_relaciones_as</span><span class="o">=</span><span class="n">crear_relaciones_as</span><span class="p">,</span> <span class="n">crear_relaciones_ph</span><span class="o">=</span><span class="n">crear_relaciones_ph</span><span class="p">,</span>
                                <span class="n">borrar_relaciones</span><span class="o">=</span><span class="n">borrar_relaciones</span><span class="p">,</span> <span class="n">proyecto</span><span class="o">=</span><span class="n">proyecto</span><span class="p">)</span>
                <span class="n">nuevo_rol</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;administracion:administrarRoles&#39;</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">RolForm</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;administracion/crearRol.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;form&#39;</span><span class="p">:</span> <span class="n">form</span><span class="p">})</span></div>


<div class="viewcode-block" id="administrar_roles"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.administrar_roles">[documentos]</a><span class="k">def</span> <span class="nf">administrar_roles</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vista que muestra los datos y acciones relacionadas a los roles</span>
<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto:  identificador del proyecto</span>
<span class="sd">    :return: render de la vista de administracion de roles</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">gerente</span> <span class="o">!=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;gerente&#39;</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;administracion/administrarRoles.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">})</span></div>


<div class="viewcode-block" id="desactivar_rol_proyecto"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.desactivar_rol_proyecto">[documentos]</a><span class="k">def</span> <span class="nf">desactivar_rol_proyecto</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">,</span> <span class="n">id_rol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vista que desactiva loroels del proyecto recibido, solo lo hace si el proyecto aun no esta iniciado y</span>
<span class="sd">    si no tiene usuarios con ese rol</span>
<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto: identificador del proyecto</span>
<span class="sd">    :param id_rol: identificador del rol</span>
<span class="sd">    :return: redirecciona a la vista de administracion de roles</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">rol</span> <span class="o">=</span> <span class="n">Rol</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_rol</span><span class="p">)</span>
    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;iniciado&#39;</span> <span class="ow">and</span> <span class="n">rol</span><span class="o">.</span><span class="n">usuarioxrol_set</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">rol</span><span class="o">.</span><span class="n">activo</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">rol</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;administracion:administrarRoles&#39;</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span></div>


<div class="viewcode-block" id="ver_roles_usuario"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.ver_roles_usuario">[documentos]</a><span class="k">def</span> <span class="nf">ver_roles_usuario</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_proyecto</span><span class="p">,</span> <span class="n">id_usuario</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vista en donde se ven los roles del usuario</span>

<span class="sd">    :param request:  objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_proyecto: identificador del proyecto</span>
<span class="sd">    :param id_usuario: identificador del usuario</span>
<span class="sd">    :return: redirecciona redirecciona a los permisos de acceso si el proyecto  es cancelado, finalizado o en ejecucion, deriva a un acceso denegado sino redirecciona a verDetallesRol.html en donde se ven los detalles de cada, con los proyectos, participantes y los roles que les corresponden.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_proyecto</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;cancelado&#39;</span> <span class="ow">or</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s1">&#39;finalizado&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;estado&#39;</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">gerente</span> <span class="o">!=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:accesoDenegado&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">id_proyecto</span><span class="p">,</span> <span class="s1">&#39;gerente&#39;</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">participante</span> <span class="o">=</span> <span class="n">Usuario</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_usuario</span><span class="p">)</span>
        <span class="n">lista_roles</span> <span class="o">=</span> <span class="p">[</span><span class="n">UsuarioxRol</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">fase</span><span class="o">=</span><span class="n">fase</span><span class="p">,</span> <span class="n">usuario</span><span class="o">=</span><span class="n">participante</span><span class="p">,</span> <span class="n">activo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">fase</span>
                       <span class="ow">in</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">fase_set</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)]</span>
        <span class="n">union_listas</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">proyecto</span><span class="o">.</span><span class="n">fase_set</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">),</span> <span class="n">lista_roles</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;administracion/verDetallesRol.html&#39;</span><span class="p">,</span> <span class="p">{</span>
            <span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">,</span>
            <span class="s1">&#39;participante&#39;</span><span class="p">:</span> <span class="n">participante</span><span class="p">,</span>
            <span class="s1">&#39;listaRol&#39;</span><span class="p">:</span> <span class="n">union_listas</span>
        <span class="p">})</span></div>


<div class="viewcode-block" id="asignar_rol_por_fase"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.asignar_rol_por_fase">[documentos]</a><span class="k">def</span> <span class="nf">asignar_rol_por_fase</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_fase</span><span class="p">,</span> <span class="n">id_usuario</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vista que permite asignar roles por fase a un participante del proyecto</span>

<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_fase: identificador de fase</span>
<span class="sd">    :param id_usuario: identificador del participante</span>
<span class="sd">    :return: redeirecciona al url asignarRol.html en los cuales se muestran el participante al cual asignar en cierta fase con la lista de roles disponibles en sistema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">participante</span> <span class="o">=</span> <span class="n">Usuario</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_usuario</span><span class="p">)</span>
    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_fase</span><span class="p">)</span>
    <span class="n">lista_usr_x_rol</span> <span class="o">=</span> <span class="n">UsuarioxRol</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">usuario</span><span class="o">=</span><span class="n">participante</span><span class="p">,</span> <span class="n">fase</span><span class="o">=</span><span class="n">fase</span><span class="p">,</span> <span class="n">activo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">roles_fase_actual</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">rol</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">lista_usr_x_rol</span><span class="p">]</span>
    <span class="n">roles_proyecto</span> <span class="o">=</span> <span class="n">Rol</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">proyecto</span><span class="o">=</span><span class="n">fase</span><span class="o">.</span><span class="n">proyecto</span><span class="p">)</span>
    <span class="n">roles_disponibles</span> <span class="o">=</span> <span class="p">[</span><span class="n">rol</span> <span class="k">for</span> <span class="n">rol</span> <span class="ow">in</span> <span class="n">roles_proyecto</span> <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">rol</span> <span class="ow">in</span> <span class="n">roles_fase_actual</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;administracion/asignarRol.html&#39;</span><span class="p">,</span> <span class="p">{</span>
        <span class="s1">&#39;participante&#39;</span><span class="p">:</span> <span class="n">participante</span><span class="p">,</span>
        <span class="s1">&#39;fase&#39;</span><span class="p">:</span> <span class="n">fase</span><span class="p">,</span>
        <span class="s1">&#39;roles_disponibles&#39;</span><span class="p">:</span> <span class="n">roles_disponibles</span>
    <span class="p">})</span></div>


<div class="viewcode-block" id="registrar_rol_por_fase"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.registrar_rol_por_fase">[documentos]</a><span class="k">def</span> <span class="nf">registrar_rol_por_fase</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_fase</span><span class="p">,</span> <span class="n">id_usuario</span><span class="p">,</span> <span class="n">id_rol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vista en la cual se registran los roles de cada fase</span>

<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_fase: identificador de la fase</span>
<span class="sd">    :param id_usuario: identificador del participante</span>
<span class="sd">    :param id_rol: identificador del rol de la fase</span>
<span class="sd">    :return: redirecciona a verRolesUsuario en donde se vera que el rol ha sido asignado correctamente.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_fase</span><span class="p">)</span>
    <span class="n">rol</span> <span class="o">=</span> <span class="n">Rol</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_rol</span><span class="p">)</span>
    <span class="n">usuario</span> <span class="o">=</span> <span class="n">Usuario</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_usuario</span><span class="p">)</span>
    <span class="n">rol_asignado</span> <span class="o">=</span> <span class="n">UsuarioxRol</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">fase</span><span class="o">=</span><span class="n">fase</span><span class="p">,</span> <span class="n">rol</span><span class="o">=</span><span class="n">rol</span><span class="p">,</span> <span class="n">usuario</span><span class="o">=</span><span class="n">usuario</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">rol_asignado</span><span class="p">:</span>
        <span class="n">rol_asignado</span> <span class="o">=</span> <span class="n">UsuarioxRol</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fase</span><span class="o">=</span><span class="n">fase</span><span class="p">,</span> <span class="n">rol</span><span class="o">=</span><span class="n">rol</span><span class="p">,</span> <span class="n">usuario</span><span class="o">=</span><span class="n">usuario</span><span class="p">)</span>
        <span class="n">rol_asignado</span><span class="o">.</span><span class="n">activo</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rol_asignado</span> <span class="o">=</span> <span class="n">UsuarioxRol</span><span class="p">(</span><span class="n">fase</span><span class="o">=</span><span class="n">fase</span><span class="p">,</span> <span class="n">rol</span><span class="o">=</span><span class="n">rol</span><span class="p">,</span> <span class="n">usuario</span><span class="o">=</span><span class="n">usuario</span><span class="p">)</span>
    <span class="n">rol_asignado</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:verRolesUsuario&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">fase</span><span class="o">.</span><span class="n">proyecto</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">id_usuario</span><span class="p">)))</span></div>


<div class="viewcode-block" id="desasignar_rol_al_usuario"><a class="viewcode-back" href="../../_autosummary/administracion.views.html#administracion.views.desasignar_rol_al_usuario">[documentos]</a><span class="k">def</span> <span class="nf">desasignar_rol_al_usuario</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">id_fase</span><span class="p">,</span> <span class="n">id_usuario</span><span class="p">,</span> <span class="n">id_rol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vista en donde se desasignan roles al usuario.</span>

<span class="sd">    :param request: objeto tipo diccionario que permite acceder a datos</span>
<span class="sd">    :param id_fase: identificador de la fase</span>
<span class="sd">    :param id_usuario: identificador del participante</span>
<span class="sd">    :param id_rol: identificador del rol</span>
<span class="sd">    :return: redirecciona a verRolesUsuario en donde se visualiza que el rol fue desasignado al usuario.&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_fase</span><span class="p">)</span>
    <span class="n">usuario</span> <span class="o">=</span> <span class="n">Usuario</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_usuario</span><span class="p">)</span>
    <span class="n">rol</span> <span class="o">=</span> <span class="n">Rol</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">id_rol</span><span class="p">)</span>
    <span class="n">rol_actual</span> <span class="o">=</span> <span class="n">UsuarioxRol</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fase</span><span class="o">=</span><span class="n">fase</span><span class="p">,</span> <span class="n">usuario</span><span class="o">=</span><span class="n">usuario</span><span class="p">,</span> <span class="n">rol</span><span class="o">=</span><span class="n">rol</span><span class="p">)</span>
    <span class="n">rol_actual</span><span class="o">.</span><span class="n">activo</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">rol_actual</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;administracion:verRolesUsuario&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">fase</span><span class="o">.</span><span class="n">proyecto</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">id_usuario</span><span class="p">)))</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Paola Olmedo, Matías López, David Nuñez, Luis Ríos

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>